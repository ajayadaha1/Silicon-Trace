FROM python:3.11-slim

WORKDIR /app

# Upgrade pip first
RUN pip install --upgrade pip

# Install core dependencies needed for MCP
RUN pip install --no-cache-dir \
    fastapi==0.109.0 \
    sqlmodel==0.0.14 \
    asyncpg==0.29.0 \
    pandas==2.2.0 \
    pydantic==2.5.3 \
    sqlalchemy[asyncio]==2.0.25

# Install FastMCP
RUN pip install --no-cache-dir fastmcp

# Copy application files
COPY models.py database.py queries.py silicon_trace_mcp.py ./

# Expose port
EXPOSE 8000

# Run MCP server
CMD ["python", "silicon_trace_mcp.py"]
